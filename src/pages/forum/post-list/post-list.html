<template ngbModalContainer></template>
<base-header [title]="title"></base-header>

<section class="content">
    post list html
    <button (click)="onClickPostCreate()">Post Write</button>

    <div *ngIf=" pages.length " class="pages"
        infinite-scroll
            [infiniteScrollDistance]="0.5"
            [infiniteScrollUpDistance]="1.1"
            [infiniteScrollThrottle]="500"
            (scrolled)="onScrollDown()"
            (scrolledUp)="onScrollUp()"
    >
        <div *ngFor=" let page of pages " class="page posts">
            <article class="post" *ngFor=" let post of page.posts ">
                <div class="post-header">
                    <h2 class="post-header-title">{{ post.subject }}</h2>
                    idx: {{ post.idx }}
                    <button (click)="onClickPostEdit( post.idx )">Edit</button>
                    <button (click)="onClickPostDelete( post.idx )">Delete</button>
                </div>

                <div class="post-content" innerHTML="{{ post.content }}">
                </div>
                
                <div *ngIf=" post.photos.length " class="files">
                    <img *ngFor=" let photo of post.photos " [src]=" photo.url_thumbnail ">
                </div>

                <table class="comment-form"
                    [class.comment-reply-form-active]="comment_reply_form_active[ post.idx.toString() ]"
                    (click)="onClickCommentForm(post)"
                    cellpadding='0' cellspacing='0'>
                    <tr valign="top">
                        <td width="1%">
                            <div class="file-upload-button" (click)="onClickCommentFileUploadButton()">
                                <span class="camera fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-camera fa-stack-1x fa-inverse"></i>
                                </span>
                                <input *ngIf=" ! cordova " type="file" name="inputFile" [(ngModel)]="inputFileValue" #file (change)="onChangeCommentFile($event, post)">
                            </div><!--/file-upload-button-->
                        </td>
                        <td>
                            <textarea name="content" [(ngModel)]="comments[post.idx.toString()]"></textarea>
                        </td>
                        <td width="1%" nowrap (click)="onClickCommentCreate( post )">
                            &nbsp;<i class="fa fa-arrow-right"></i>
                        </td>
                    </tr>
                </table>

                <div class="comments" *ngIf=" post.comments ">
                    <article class="comment" *ngFor=" let comment of post.comments " [attr.depth]="comment.depth">
                        No. {{ comment.idx }}
                        <div innerHTML="{{ comment.content }}"></div>
                        <button (click)="onClickCommentReply( comment, post )">Reply</button>
                        <button (click)="onClickCommentEdit( comment, post )">Edit</button>
                        <button (click)="onClickCommentDelete( comment, post )">DELETE</button>
                    </article>
                </div>

            </article><!-- post -->
        </div><!--/page posts-->
    </div><!--pages-->
</section>


<base-footer></base-footer>

